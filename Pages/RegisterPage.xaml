<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Mikkee.Converters"
             xmlns:models="clr-namespace:Mikkee.Models"
             x:Class="Mikkee.Pages.RegisterPage"
             x:DataType="models:Course"
             >
    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:BooleanToTextConverter x:Key="BooleanToTextConverter" />
            <converters:BooleanToCommandConverter x:Key="BooleanToCommandConverter" />
            <converters:SubIdExistsConverter x:Key="SubIdExistsConverter" />
            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, *" Padding="10">
        <!-- Search Bar -->
        <SearchBar Placeholder="ค้นหารายวิชา..." 
                   TextChanged="OnSearchTextChanged" 
                   Grid.Row="0" />

        <!-- List View for Courses -->
<ListView x:Name="CoursesListView" 
          ItemsSource="{Binding Courses}" 
          Grid.Row="1">
    <ListView.ItemTemplate>
        <DataTemplate x:DataType="models:Course2">
            <ViewCell>
                <HorizontalStackLayout Spacing="10">
                    <Label Text="{Binding CourseCode}" FontSize="16" />
                    <Label Text="{Binding CourseName}" FontSize="16" />
                    <!-- ปุ่มลงทะเบียน -->
                    <Button Text="ลงทะเบียน"
                            IsVisible="{Binding SubId, Converter={StaticResource SubIdExistsConverter}}"
                            BackgroundColor="#6200EA"
                            TextColor="White"
                            CornerRadius="10"
                            HeightRequest="40"
                            WidthRequest="120"
                            Clicked ="Addsub"
                             />

                    <!-- ปุ่มถอนวิชา -->
                    <Button Text="ถอนวิชา"
                            IsVisible="{Binding SubId, Converter={StaticResource SubIdExistsConverter}, ConverterParameter=true}"
                            BackgroundColor="#FF5722"
                            TextColor="White"
                            CornerRadius="10"
                            HeightRequest="40"
                            WidthRequest="120"
                            Clicked ="Deletesub"
                             />
                </HorizontalStackLayout>
            </ViewCell>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView>

    </Grid>
</ContentPage>
